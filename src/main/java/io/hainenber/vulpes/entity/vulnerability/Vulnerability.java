package io.hainenber.vulpes.entity.vulnerability;

import com.fasterxml.jackson.annotation.JsonProperty;
import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.Id;
import org.hibernate.annotations.JdbcTypeCode;
import org.hibernate.type.SqlTypes;

import java.sql.Timestamp;
import java.util.List;

@Entity
public class Vulnerability {
    @Id
    @JsonProperty("id")
    private String id;

    @JsonProperty("schema_version")
    @Column(name = "schema_version")
    private String schemaVersion;

    @JsonProperty("modified")
    @Column(name = "modified")
    private Timestamp modified;

    @JsonProperty("published")
    @Column(name = "published")
    private Timestamp published;

    @JsonProperty("withdrawn")
    @Column(name = "withdrawn")
    private Timestamp withdrawn;

    @JsonProperty("aliases")
    @Column(name = "aliases")
    private List<String> aliases;

    @JsonProperty("related")
    @Column(name = "related")
    private List<String> related;

    @JsonProperty("summary")
    @Column(name = "summary", columnDefinition = "TEXT")
    private String summary;

    @JsonProperty("details")
    @Column(name = "details", columnDefinition = "TEXT")
    private String details;

    @JsonProperty("severity")
    @Column(name = "severity")
    @JdbcTypeCode(SqlTypes.JSON)
    private List<VulnerabilitySeverity> severity;

    @JsonProperty("affected")
    @Column(name = "affected")
    @JdbcTypeCode(SqlTypes.JSON)
    private List<VulnerabilityAffectionData> affected;

    @JsonProperty("references")
    @Column(name = "\"references\"") // SQL reserved word, needs to enclose with double-quotes.
    @JdbcTypeCode(SqlTypes.JSON)
    private List<VulnerabilityReference> references;

    @JsonProperty("credits")
    @Column(name = "credits")
    @JdbcTypeCode(SqlTypes.JSON)
    private List<VulnerabilityCredit> credits;

    @JsonProperty("database_specific")
    @Column(name = "database_specific")
    @JdbcTypeCode(SqlTypes.JSON)
    private VulnerabilityDatabaseSpecificData databaseSpecific;

    @SuppressWarnings("unused") // Exists for JPA only
    protected Vulnerability() { }

    public String getId() {
        return id;
    }
}
